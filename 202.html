<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≠‡∏ô</title>

<style>
/* ===== ACCORDION ===== */
.ep-toggle{
  background:#111;
  border-radius:16px;
  padding:18px;
  margin-bottom:14px;
  cursor:pointer;
  font-size:1.1rem;
  box-shadow:0 6px 14px rgba(0,0,0,.4);
}
.ep-list{
  max-height:0;
  overflow:hidden;
  transition:max-height .45s ease;
}
.ep-list.open{ max-height:3000px; }

/* ===== BASE ===== */
body{
  margin:0;
  color:#fff;
  font-family:sans-serif;
  background:url("https://www.akerufeed.com/wp-content/uploads/2021/07/Wallpaper-Japanese-Cartoon-Street-22.jpg")
  center/cover fixed;
}
.container{ max-width:540px; margin:auto; padding:16px; }

/* ===== CARD ===== */
.card img{ width:330px;height:430px;border-radius:16px; }
.desc{ line-height:1.6; opacity:.9; }

/* ===== PLAYER ===== */
iframe{
  width:100%;
  height:220px;
  border:none;
  border-radius:16px;
  margin:16px 0;
}

/* ===== EP ===== */
.episode{
  background:linear-gradient(135deg,#1e1e1e,#2b2b2b);
  border-radius:16px;
  padding:18px;
  margin-bottom:14px;
  display:flex;
  gap:14px;
  cursor:pointer;
}
.episode.watched{
  background:linear-gradient(135deg,#1b3b1b,#244d24);
}
.ep-num{
  background:#ff4d4d;
  padding:8px 14px;
  border-radius:12px;
}
.ep-title{ flex:1; }
</style>
</head>

<body>
<div class="container">

<h2>Sword Art Online (‡∏†‡∏≤‡∏Ñ 1)</h2>

<img src="https://anifume.com/images/18/Sword-Art-Online-1.jpg">

<p class="desc">
‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á Sword Art Online ...
</p>

<!-- PLAYER -->
<iframe id="player" allowfullscreen></iframe>

<div class="ep-toggle" onclick="toggleEp()">‚ñº ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≠‡∏ô</div>

<div id="epList" class="ep-list"></div>

</div>

<script>
/* üî• ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ */
const SHEET_ID = "1r2QhYu826ZomrOOAOmAjsHfWv17aVmnBFylaeKnfsU8";
const animeName = "Sword Art Online";

const SHEET_URL =
`https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

let watched = JSON.parse(localStorage.getItem(animeName)) || [];
const epList = document.getElementById("epList");
const player = document.getElementById("player");

fetch(SHEET_URL)
.then(r=>r.text())
.then(t=>{
  const json = JSON.parse(t.substring(47).slice(0,-2));
  json.table.rows.forEach(row=>{
    if(row.c[0].v !== animeName) return;

    const ep = row.c[1].v;
    const title = row.c[2].v;
    const url = row.c[3].v;

    const div = document.createElement("div");
    div.className = "episode";
    if(watched.includes(ep)) div.classList.add("watched");

    div.innerHTML = `
      <span class="ep-num">EP ${ep}</span>
      <span class="ep-title">${title}</span>
      <span>${watched.includes(ep)?"‚úî":""}</span>
    `;

    div.onclick=()=>{
      player.src = url;
      if(!watched.includes(ep)){
        watched.push(ep);
        localStorage.setItem(animeName,JSON.stringify(watched));
        div.classList.add("watched");
        div.querySelector("span:last-child").textContent="‚úî";
      }
      window.scrollTo({top:0,behavior:"smooth"});
    };

    epList.appendChild(div);
  });
});

function toggleEp(){
  epList.classList.toggle("open");
}
</script>

</body>
</html>