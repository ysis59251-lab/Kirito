<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>AnimeFume Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  background:#0b0b0b;
  color:#fff;
  font-family:system-ui;
  padding:16px;
}
h2{color:#00ffcc}
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:12px;
}
.card{
  background:#111;
  padding:14px;
  border-radius:12px;
  border:1px solid #222;
}
.section{
  margin-top:20px;
  background:#111;
  padding:16px;
  border-radius:14px;
  border:1px solid #222;
}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #222;padding:8px;text-align:center}
th{color:#00ffcc}
.progress{height:8px;background:#222;border-radius:10px}
.bar{height:100%;background:linear-gradient(90deg,#00ffcc,#00cfa8)}
</style>
</head>

<body>

<h2>üìä AnimeFume Dashboard</h2>

<div class="cards">
  <div class="card">‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î<br><b id="aCount">0</b></div>
  <div class="card">‡∏ï‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î<br><b id="eTotal">0</b></div>
  <div class="card">‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß<br><b id="eDone">0</b></div>
  <div class="card">‡πÄ‡∏´‡∏•‡∏∑‡∏≠<br><b id="eWait">0</b></div>
</div>

<div class="section">
  <canvas id="chart"></canvas>
</div>

<div class="section">
<table>
<thead>
<tr>
<th>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</th><th>‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th><th>‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß</th><th>‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th><th>%</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>
</div>

<script>
let pie;

async function load(){
  const res = await fetch("episodes.json?ts="+Date.now());
  const data = await res.json();

  let total=0,done=0;
  list.innerHTML="";

  data.anime.forEach(a=>{
    total+=a.total;
    done+=a.episodes;
    const p=Math.round(a.episodes/a.total*100);

    list.innerHTML+=`
    <tr>
      <td>${a.title}</td>
      <td>${a.total}</td>
      <td>${a.episodes}</td>
      <td>${a.total-a.episodes}</td>
      <td>${p}%
        <div class="progress"><div class="bar" style="width:${p}%"></div></div>
      </td>
    </tr>`;
  });

  aCount.textContent=data.anime.length;
  eTotal.textContent=total;
  eDone.textContent=done;
  eWait.textContent=total-done;

  if(pie) pie.destroy();
  pie=new Chart(chart,{
    type:"doughnut",
    data:{
      labels:["‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß","‡πÄ‡∏´‡∏•‡∏∑‡∏≠"],
      datasets:[{data:[done,total-done],backgroundColor:["#00ffcc","#333"]}]
    }
  });
}

load();
setInterval(load,5000);
</script>

</body>
</html>