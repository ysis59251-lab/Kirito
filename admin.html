<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>AnimeFume Dashboard</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{background:#0b0b0b;color:#fff;font-family:system-ui;padding:16px}
h2{color:#00ffcc}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px}
.card{background:#111;padding:14px;border-radius:12px;border:1px solid #222}
.section{margin-top:20px;background:#111;padding:16px;border-radius:14px;border:1px solid #222}

/* MAIL */
#mailBox{
  position:fixed;top:16px;right:16px;
  width:48px;height:48px;
  background:#ff3b3b;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:20px;cursor:pointer;z-index:1000
}
#mailCount{
  position:absolute;top:-6px;right:-6px;
  background:#000;color:#fff;font-size:11px;
  padding:2px 6px;border-radius:10px
}
#inbox{
  position:fixed;top:80px;right:16px;
  width:320px;max-height:420px;
  background:#111;border-radius:14px;
  padding:12px;display:none;flex-direction:column;
  box-shadow:0 10px 30px rgba(0,0,0,.7)
}
.report-item{
  background:#000;border:1px solid #222;
  border-radius:10px;padding:8px;
  margin-bottom:8px;font-size:12px
}
.report-item.new{border-color:#ff3b3b}
</style>
</head>

<body>

<div id="mailBox" onclick="toggleInbox()">ğŸ“¢<span id="mailCount">0</span></div>
<div id="inbox">
  <h3>ğŸ“¬ à¹à¸ˆà¹‰à¸‡à¸›à¸±à¸à¸«à¸²</h3>
  <div id="reportList"></div>
</div>

<h2>ğŸ“Š AnimeFume Dashboard</h2>
<div class="cards">
  <div class="card">ğŸ‘ï¸ à¸¢à¸­à¸”à¸”à¸¹à¸£à¸§à¸¡<br><b id="views">0</b></div>
  <div class="card">ğŸ“š à¹€à¸£à¸·à¹ˆà¸­à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”<br><b id="aCount">0</b></div>
</div>

<script type="module">
/* ================= FIREBASE ================= */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

/* ğŸ”¥ à¹ƒà¸ªà¹ˆà¸‚à¸­à¸‡à¸„à¸¸à¸“à¸•à¸£à¸‡à¸™à¸µà¹‰ */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT.firebaseio.com",
  projectId: "YOUR_PROJECT",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "XXXX",
  appId: "XXXX"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* ================= REPORT SYSTEM (Local) ================= */
const KEY_REPORT = "reports";
const getReports = () =>
  JSON.parse(localStorage.getItem(KEY_REPORT) || "[]");
const saveReports = d =>
  localStorage.setItem(KEY_REPORT, JSON.stringify(d));

/* DEMO DATA (à¸¥à¸šà¸—à¸´à¹‰à¸‡à¹„à¸”à¹‰) */
if (!getReports().length) {
  saveReports([{
    time: new Date().toLocaleString(),
    page: "à¸«à¸™à¹‰à¸²à¹à¸£à¸",
    detail: "à¸§à¸´à¸”à¸µà¹‚à¸­à¹€à¸¥à¹ˆà¸™à¹„à¸¡à¹ˆà¹„à¸”à¹‰",
    read: false
  }]);
}

/* ================= INBOX ================= */
window.toggleInbox = () => {
  const box = document.getElementById("inbox");
  box.style.display = box.style.display === "flex" ? "none" : "flex";
  renderInbox();
};

function renderInbox() {
  const reports = getReports();
  const list = document.getElementById("reportList");
  const badge = document.getElementById("mailCount");

  badge.textContent = reports.filter(r => !r.read).length;
  list.innerHTML = "";

  if (!reports.length) {
    list.innerHTML = "<p style='color:#777'>à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¹à¸ˆà¹‰à¸‡à¸›à¸±à¸à¸«à¸²</p>";
    return;
  }

  reports.slice().reverse().forEach((r, i) => {
    const index = reports.length - 1 - i;
    list.innerHTML += `
      <div class="report-item ${r.read ? "" : "new"}"
        onclick="markRead(${index})">
        <small>ğŸ•’ ${r.time}</small><br>
        <small>ğŸ“„ ${r.page}</small>
        <p>${r.detail}</p>
      </div>`;
  });
}

window.markRead = index => {
  const r = getReports();
  if (!r[index]) return;
  r[index].read = true;
  saveReports(r);
  renderInbox();
};

renderInbox();
</script>

</body>
</html>